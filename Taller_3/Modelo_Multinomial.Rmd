---
title: "Taller 3 - Modelo Regresión Multinomial"
author:
  - name: "Jhon Tascon Velasco"
  - name: "Lino Sinisterra"
  - name: "Juan Chacon"
date: "2025-09-15"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Supuesto IIA**

El supuesto IIA establece que la razón de probabilidades entre dos alternativas cualesquiera es independiente de la presencia o características de otras alternativas en el conjunto de elección.

Formalmente: Si tienes tres alternativas  A, B y C, el supuesto IIA implica que:


$$
\frac{P(A)}{P(B)} \text{ es independiente de la existencia o característica de } C
$$ 

Esto significa que si se elimina o se agrega una alternativa irrelevante (como C), la relación entre A y B no debería cambiar.

Implicaciones empíricas:

1. **Restricción de comportamiento:** El IIA impone una estructura rígida en el comportamiento del consumidor o decisor. Por ejemplo, si alguien elige entre tren y autobús, y se introduce una nueva opción como "autobús premium", el modelo MNL asumiría que la relación entre tren y autobús regular no cambia, lo cual puede no ser realista.
2. **Problemas en la modelación:** En contextos donde las alternativas son similares o correlacionadas, el supuesto IIA puede llevar a predicciones erróneas. Ejemplo clásico: la "paradoja de la línea roja" en transporte público.
3. **Tests empíricos:** Se pueden aplicar pruebas como el test de **Hausman-McFadden** para verificar si el supuesto IIA se cumple. Si se rechaza, se recomienda usar modelos más flexibles como:

    - Logit anidado (Nested Logit)
    - Logit mixto (Mixed Logit)
    - Probit multinomial

En el test de Hausman-McFadden, si p > 0.05, no se rechaza el spuesto de IIA, por lo tanto el modelo logit es apropiado.


```{r, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
library(dplyr)
library(ggplot2)
library(caret)
library(class)
library(tidyverse)
library(plotly)
library(ggcorrplot)
library("easypackages")
library(quantreg)
library(broom)
library(purrr)
library(knitr)
library(kableExtra)
```

## **0. Información general**

Este trabajo consiste identificar un caso real donde el interés esté en colas de la distribución (poblaciones muy vulnerables o muy favorecidas) y mostrar cómo la regresión cuantil (QR) revela patrones que el promedio (OLS) oculta.

En este caso, haremos el ejercicio con el dataset "Evaluación de la polución y calidad del aire" de kaggle: https://www.kaggle.com/datasets/mujtabamatin/air-quality-and-pollution-assessment. Este dataset se enfoca en envaluaciones de la calidad de aire en varias regiones del mundo. El dataset contiene 5000 muestras capturando factores ambientales y demográficos que influyen en los niveles de polución.

La pregunta de investigación es: ¿Cómo influyen los facotres meteorológicos, de densidad de población y cercanía a zonas industriales los diferentes niveles de CO?

## **1. Análisis exploratorio**

Las variables a analizar son las siguientes:

```{r tabla_variables, echo=FALSE}
library(knitr)
library(kableExtra)

variables <- data.frame(
  Variables = c("Temperatura", 
                "Humedad", 
                "Concentración PM2.5", 
                "Concentración PM10", 
                "Concentración NO2", 
                "Concentración SO2", 
                "Cercanía a Áreas Industriales", 
                "Densidad de población", 
                "Calidad del aire", 
                "Concentración de CO"),
  Unidades = c("°C", 
               "%", 
               "µg/m³", 
               "µg/m³", 
               "ppb", 
               "ppb", 
               "km", 
               "personas/km²", 
               "Categorías", 
               "ppb"),
  Descripción = c("Temperatura media de la región", 
                  "Humedad relativa registrada en la región", 
                  "Niveles de partículas finas", 
                  "Niveles de partículas gruesas (no se trabajará en el estudio)", 
                  "Niveles de dióxido de nitrógeno (no se trabajará en el estudio)", 
                  "Niveles de dióxido de azufre (no se trabajará en el estudio)", 
                  "Distancia a la zona industrial más cercana", 
                  "Número de personas por kilómetro cuadrado en la región", 
                  "Clasificación: Bueno, Moderado, Pobre, Peligroso", 
                  "Variable objetivo: Niveles de monóxido de carbono")
)

kable(variables, format = "html", caption = "Descripción de variables del estudio", align = "c") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"),
                full_width = FALSE, position = "center") %>%
  row_spec(nrow(variables), bold = TRUE)  
```